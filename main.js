/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NathanDeleteImage
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  deleteOption: ".trash",
  logsModal: true
};
var NathanDeleteImageSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Fast Image Cleaner Settings" });
    new import_obsidian.Setting(containerEl).setName("Deleted Image Destination").setDesc("Select where you want images to be moved once they are deleted").addDropdown((dropdown) => {
      dropdown.addOption("permanent", "Delete Permanently");
      dropdown.addOption(".trash", "Move to Obsidian Trash");
      dropdown.addOption("system-trash", "Move to System Trash");
      dropdown.setValue(this.plugin.settings.deleteOption);
      dropdown.onChange((option) => {
        this.plugin.settings.deleteOption = option;
        this.plugin.saveSettings();
      });
    });
  }
};

// src/util.ts
var import_obsidian2 = require("obsidian");
var SUCCESS_NOTICE_TIMEOUT = 1800;
var getAllImgDivs = () => {
  var _a;
  const leaf_active = document.getElementsByClassName("workspace-leaf mod-active");
  const preview_content = leaf_active[0].getElementsByClassName("markdown-source-view cm-s-obsidian mod-cm6 is-folding is-live-preview node-insert-event");
  const embed_divs = (_a = preview_content[0]) == null ? void 0 : _a.getElementsByClassName("internal-embed media-embed image-embed is-loaded");
  return embed_divs;
};
var trimFromRegExp = (origin_str, regex) => {
  const matching_array = Array.from(origin_str.matchAll(regex));
  for (let i = 0; i < matching_array.length; i++) {
    origin_str = origin_str.replace(matching_array[i][0], "");
  }
  return origin_str;
};
var removeReferenceLink = async (imagePath, mdFile) => {
  const origin_filecontents = await app.vault.read(mdFile);
  const new_filecontents = [];
  const fileContents_array = origin_filecontents.split("\n");
  for (const fileContent of fileContents_array) {
    const regRefLink1 = new RegExp("!\\[(.*)?\\]\\(((.*\\/)+)?" + imagePath + "\\)", "gm");
    const regRefLink2 = new RegExp("!\\[\\[.*?" + imagePath + "\\]\\]", "gm");
    const isEscaped = fileContent.includes("%20");
    const fileContent_decode = decodeURI(fileContent);
    const isIncludeImage = fileContent_decode.includes(imagePath);
    const isMarkdownStyle = fileContent_decode.match(regRefLink1) != null;
    const isWikiStyle = fileContent_decode.match(regRefLink2) != null;
    if (isEscaped) {
      if (isIncludeImage && isMarkdownStyle) {
        new_filecontents.push(trimFromRegExp(fileContent_decode, regRefLink1));
      } else if (isIncludeImage && isWikiStyle) {
        new_filecontents.push(trimFromRegExp(fileContent_decode, regRefLink2));
      } else {
        new_filecontents.push(fileContent);
      }
    } else {
      if (isIncludeImage && isMarkdownStyle) {
        new_filecontents.push(trimFromRegExp(fileContent_decode, regRefLink1));
      } else if (isIncludeImage && isWikiStyle) {
        new_filecontents.push(trimFromRegExp(fileContent_decode, regRefLink2));
      } else {
        new_filecontents.push(fileContent);
      }
    }
  }
  app.vault.adapter.write(mdFile.path, new_filecontents.join("\n"));
};
var addDelBtn = (img_list) => {
  for (let index = 0; index < (img_list == null ? void 0 : img_list.length); index++) {
    const btn_del = document.createElement("button");
    btn_del.setAttribute("class", "btn-delete");
    btn_del.setAttribute("aria-label", "Delete current image");
    btn_del.innerHTML = '<svg fill="#ff0000" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="48px" height="48px"><path d="M 28 7 C 25.243 7 23 9.243 23 12 L 23 15 L 13 15 C 11.896 15 11 15.896 11 17 C 11 18.104 11.896 19 13 19 L 15.109375 19 L 16.792969 49.332031 C 16.970969 52.510031 19.600203 55 22.783203 55 L 41.216797 55 C 44.398797 55 47.029031 52.510031 47.207031 49.332031 L 48.890625 19 L 51 19 C 52.104 19 53 18.104 53 17 C 53 15.896 52.104 15 51 15 L 41 15 L 41 12 C 41 9.243 38.757 7 36 7 L 28 7 z M 28 11 L 36 11 C 36.552 11 37 11.449 37 12 L 37 15 L 27 15 L 27 12 C 27 11.449 27.448 11 28 11 z M 19.113281 19 L 44.886719 19 L 43.212891 49.109375 C 43.153891 50.169375 42.277797 51 41.216797 51 L 22.783203 51 C 21.723203 51 20.846109 50.170328 20.787109 49.111328 L 19.113281 19 z M 32 23.25 C 31.033 23.25 30.25 24.034 30.25 25 L 30.25 45 C 30.25 45.966 31.033 46.75 32 46.75 C 32.967 46.75 33.75 45.966 33.75 45 L 33.75 25 C 33.75 24.034 32.967 23.25 32 23.25 z M 24.642578 23.251953 C 23.677578 23.285953 22.922078 24.094547 22.955078 25.060547 L 23.652344 45.146484 C 23.685344 46.091484 24.462391 46.835938 25.400391 46.835938 C 25.421391 46.835938 25.441891 46.835938 25.462891 46.835938 C 26.427891 46.801938 27.183391 45.991391 27.150391 45.025391 L 26.453125 24.939453 C 26.419125 23.974453 25.606578 23.228953 24.642578 23.251953 z M 39.355469 23.251953 C 38.388469 23.224953 37.580875 23.974453 37.546875 24.939453 L 36.849609 45.025391 C 36.815609 45.991391 37.571109 46.801938 38.537109 46.835938 C 38.558109 46.836938 38.578609 46.835938 38.599609 46.835938 C 39.537609 46.835938 40.314656 46.091484 40.347656 45.146484 L 41.044922 25.060547 C 41.078922 24.094547 40.321469 23.285953 39.355469 23.251953 z" /></svg>';
    img_list[index].appendChild(btn_del);
  }
};
var clearAllDelBtns = () => {
  const btn_dels = document.getElementsByClassName("btn-delete");
  Array.from(btn_dels).forEach((btn_del) => {
    var _a;
    (_a = btn_del.parentNode) == null ? void 0 : _a.removeChild(btn_del);
  });
};
var isRemoveImage = (imageName) => {
  const currentMd = app.workspace.getActiveFile();
  const de_img = getImageFileByName(currentMd, imageName);
  if (de_img == void 0) {
    new import_obsidian2.Notice(` 1111`);
  }
  const md_path = [];
  let cur_md_path = "";
  let ref_num = 0;
  const resolvedLinks = app.metadataCache.resolvedLinks;
  le.log("de_img path--------" + de_img.path);
  for (const [mdFile, links] of Object.entries(resolvedLinks)) {
    if (currentMd.path === mdFile) {
      cur_md_path = currentMd.path;
      md_path.unshift(cur_md_path);
    }
    for (const [filePath, nr] of Object.entries(links)) {
      if (de_img.path === filePath) {
        ref_num++;
        if (nr > 1) {
          ref_num += 1;
        }
        md_path.push(mdFile);
      }
    }
  }
  const result = ref_num > 1 ? false : true;
  return [result, md_path];
};
var getImageFileByName = (currentMd, imageName) => {
  const resolvedLinks = app.metadataCache.resolvedLinks;
  for (const [mdFile, links] of Object.entries(resolvedLinks)) {
    if (currentMd.path === mdFile) {
      for (const [filePath, nr] of Object.entries(links)) {
        if (filePath.includes(imageName)) {
          try {
            const imageFile = app.vault.getAbstractFileByPath(filePath);
            if (imageFile instanceof import_obsidian2.TFile) {
              return imageFile;
            }
          } catch (error) {
            new import_obsidian2.Notice(` cannot get the image file`);
            return void 0;
          }
        }
      }
    }
  }
};
var deleteImg = (targetImg, imageName, plugin) => {
  const deleteOption = plugin.settings.deleteOption;
  let file;
  const imgType = targetImg.localName;
  switch (imgType) {
    case "img": {
      const imageUrl = targetImg.currentSrc;
      const thisURL = new URL(imageUrl);
      const currentMd = app.workspace.getActiveFile();
      file = getImageFileByName(currentMd, imageName);
      if (file == void 0) {
        console.error(" cannot get image file ");
      }
      const Proto = thisURL.protocol;
      switch (Proto) {
        case "app:":
        case "data:":
        case "http:":
        case "https:":
          removeReferenceLink(imageName, app.workspace.getActiveFile());
          if (deleteOption === ".trash") {
            app.vault.trash(file, false);
            new import_obsidian2.Notice("Image moved to Obsidian Trash !", SUCCESS_NOTICE_TIMEOUT);
          } else if (deleteOption === "system-trash") {
            app.vault.trash(file, true);
            new import_obsidian2.Notice("Image moved to System Trash !", SUCCESS_NOTICE_TIMEOUT);
          } else if (deleteOption === "permanent") {
            app.vault.delete(file);
            new import_obsidian2.Notice("Image deleted Permanently !", SUCCESS_NOTICE_TIMEOUT);
          }
          break;
        default:
          new import_obsidian2.Notice(`no handler for ${Proto} protocol`);
          return;
      }
      break;
    }
    default:
      new import_obsidian2.Notice("No handler for this image type!");
      return;
  }
};

// src/modals.ts
var import_obsidian3 = require("obsidian");
var LogsModal = class extends import_obsidian3.Modal {
  constructor(currentMd, imgBaseName, textToView, app2) {
    super(app2);
    this.textToView = textToView;
    this.currentMd = currentMd;
    this.imgBaseName = imgBaseName;
  }
  getLog() {
    const fistEle = this.textToView.shift();
    const cur_md = "The md document that currently references the image: </br>" + fistEle + "</br></br>";
    let other_md = this.textToView.join("</br>");
    other_md = "List of all documents that reference this image: </br>" + other_md;
    const log = cur_md + other_md;
    return log;
  }
  onOpen() {
    const { contentEl } = this;
    const myModal = this;
    const headerWrapper = contentEl.createEl("div");
    headerWrapper.addClass("fast-image-cleaner-center-wrapper");
    const headerEl = headerWrapper.createEl("h1", {
      text: " Detection of multiple image reference links - logs "
    });
    headerEl.addClass("modal-title");
    const logs = contentEl.createEl("div");
    logs.addClass("fast-image-cleaner-log");
    logs.innerHTML = this.getLog();
    const buttonWrapper = contentEl.createEl("div");
    buttonWrapper.addClass("fast-image-cleaner-center-wrapper");
    const closeButton = buttonWrapper.createEl("button", { text: "close" });
    const removeLinkButton = buttonWrapper.createEl("button", {
      text: "remove link"
    });
    closeButton.addClass("unused-images-button");
    closeButton.setAttribute("aria-label", "close the window");
    removeLinkButton.addClass("unused-images-button");
    removeLinkButton.setAttribute("aria-label", "Continue to remove the reference link to the current image in the current document");
    closeButton.addEventListener("click", () => {
      myModal.close();
    });
    removeLinkButton.addEventListener("click", () => {
      removeReferenceLink(this.imgBaseName, this.currentMd);
      myModal.close();
    });
  }
};

// src/main.ts
var img_target;
var NathanDeleteImage = class extends import_obsidian4.Plugin {
  async onload() {
    console.log("Fast Image Cleaner plugin loaded...");
    this.addSettingTab(new NathanDeleteImageSettingsTab(this.app, this));
    await this.loadSettings();
    this.registerDocument(document);
    app.workspace.on("window-open", (workspaceWindow, window2) => {
      this.registerDocument(window2.document);
    });
    app.workspace.on("file-open", () => {
      clearAllDelBtns();
      addDelBtn(getAllImgDivs());
    });
    app.workspace.on("editor-change", () => {
      clearAllDelBtns();
      addDelBtn(getAllImgDivs());
    });
    app.workspace.on("active-leaf-change", () => {
      clearAllDelBtns();
      addDelBtn(getAllImgDivs());
    });
    this.registerInterval(window.setInterval(() => console.log("setInterval"), 5 * 60 * 1e3));
  }
  onunload() {
    console.log("Fast Image Cleaner plugin unloaded...");
  }
  onElement(el, event, selector, listener, options) {
    el.on(event, selector, listener, options);
    return () => el.off(event, selector, listener, options);
  }
  registerDocument(document2) {
    this.register(this.onElement(document2, "click", ".btn-delete", this.onClick.bind(this)));
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  onClick(event) {
    var _a, _b;
    event.preventDefault();
    const target = event.target;
    const nodeType = target.localName;
    let del_btn = document.createElement("button");
    if (nodeType === "button" || nodeType === "svg" || nodeType === "path") {
      del_btn = target.closest(".btn-delete");
      img_target = (_a = del_btn.parentNode) == null ? void 0 : _a.querySelector("img");
      const currentMd = app.workspace.getActiveFile();
      const imgBaseName = (_b = img_target.parentElement) == null ? void 0 : _b.getAttribute("src");
      if (isRemoveImage(imgBaseName)[0]) {
        deleteImg(img_target, imgBaseName, this);
      } else {
        const logs = isRemoveImage(imgBaseName)[1];
        const modal = new LogsModal(currentMd, imgBaseName, logs, this.app);
        modal.open();
      }
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy91dGlsLnRzIiwgInNyYy9tb2RhbHMudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFBsdWdpbiwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgTmF0aGFuRGVsZXRlSW1hZ2VTZXR0aW5nc1RhYiB9IGZyb20gXCIuL3NldHRpbmdzXCI7XHJcbmltcG9ydCB7IE5hdGhhbkRlbGV0ZUltYWdlU2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tIFwiLi9zZXR0aW5nc1wiO1xyXG5pbXBvcnQgKiBhcyBVdGlsIGZyb20gXCIuL3V0aWxcIjtcclxuaW1wb3J0IHsgTG9nc01vZGFsIH0gZnJvbSBcIi4vbW9kYWxzXCI7XHJcblxyXG5sZXQgaW1nX3RhcmdldDogSFRNTEltYWdlRWxlbWVudDtcclxuXHJcbmludGVyZmFjZSBMaXN0ZW5lciB7XHJcblx0KHRoaXM6IERvY3VtZW50LCBldjogRXZlbnQpOiBhbnk7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE5hdGhhbkRlbGV0ZUltYWdlIGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogTmF0aGFuRGVsZXRlSW1hZ2VTZXR0aW5ncztcclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblx0XHRjb25zb2xlLmxvZyhcIkZhc3QgSW1hZ2UgQ2xlYW5lciBwbHVnaW4gbG9hZGVkLi4uXCIpO1xyXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBOYXRoYW5EZWxldGVJbWFnZVNldHRpbmdzVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cdFx0dGhpcy5yZWdpc3RlckRvY3VtZW50KGRvY3VtZW50KTsgXHJcblxyXG5cdFx0YXBwLndvcmtzcGFjZS5vbihcclxuXHRcdFx0XCJ3aW5kb3ctb3BlblwiLCBcclxuXHRcdFx0KHdvcmtzcGFjZVdpbmRvdywgd2luZG93KSA9PiB7XHJcblx0XHRcdFx0dGhpcy5yZWdpc3RlckRvY3VtZW50KHdpbmRvdy5kb2N1bWVudCk7XHJcblx0XHRcdH1cclxuXHRcdCk7XHJcblx0XHRhcHAud29ya3NwYWNlLm9uKFwiZmlsZS1vcGVuXCIsICgpID0+IHtcclxuXHRcdFx0VXRpbC5jbGVhckFsbERlbEJ0bnMoKTtcclxuXHRcdFx0VXRpbC5hZGREZWxCdG4oVXRpbC5nZXRBbGxJbWdEaXZzKCkpO1xyXG5cdFx0fSk7XHJcblx0XHRhcHAud29ya3NwYWNlLm9uKFwiZWRpdG9yLWNoYW5nZVwiLCAoKSA9PiB7XHJcblx0XHRcdFV0aWwuY2xlYXJBbGxEZWxCdG5zKCk7XHJcblx0XHRcdFV0aWwuYWRkRGVsQnRuKFV0aWwuZ2V0QWxsSW1nRGl2cygpKTtcclxuXHRcdH0pO1xyXG5cdFx0YXBwLndvcmtzcGFjZS5vbihcImFjdGl2ZS1sZWFmLWNoYW5nZVwiLCAoKSA9PiB7XHJcblx0XHRcdFV0aWwuY2xlYXJBbGxEZWxCdG5zKCk7XHJcblx0XHRcdFV0aWwuYWRkRGVsQnRuKFV0aWwuZ2V0QWxsSW1nRGl2cygpKTtcclxuXHRcdH0pO1xyXG5cdFx0dGhpcy5yZWdpc3RlckludGVydmFsKFxyXG5cdFx0XHR3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gY29uc29sZS5sb2coXCJzZXRJbnRlcnZhbFwiKSwgNSAqIDYwICogMTAwMClcclxuXHRcdCk7XHJcblx0fVxyXG5cdG9udW5sb2FkKCkge1xyXG5cdFx0Y29uc29sZS5sb2coXCJGYXN0IEltYWdlIENsZWFuZXIgcGx1Z2luIHVubG9hZGVkLi4uXCIpO1xyXG5cdH1cclxuXHJcblx0b25FbGVtZW50KFxyXG5cdFx0ZWw6IERvY3VtZW50LFxyXG5cdFx0ZXZlbnQ6IGtleW9mIEhUTUxFbGVtZW50RXZlbnRNYXAsXHJcblx0XHRzZWxlY3Rvcjogc3RyaW5nLFxyXG5cdFx0bGlzdGVuZXI6IExpc3RlbmVyLFxyXG5cdFx0b3B0aW9ucz86IHsgY2FwdHVyZT86IGJvb2xlYW4gfVxyXG5cdCkge1xyXG5cdFx0ZWwub24oZXZlbnQsIHNlbGVjdG9yLCBsaXN0ZW5lciwgb3B0aW9ucyk7XHJcblx0XHRyZXR1cm4gKCkgPT4gZWwub2ZmKGV2ZW50LCBzZWxlY3RvciwgbGlzdGVuZXIsIG9wdGlvbnMpO1xyXG5cdH1cclxuXHRyZWdpc3RlckRvY3VtZW50KGRvY3VtZW50OiBEb2N1bWVudCkge1xyXG5cdFx0dGhpcy5yZWdpc3RlcihcclxuXHRcdFx0dGhpcy5vbkVsZW1lbnQoXHJcblx0XHRcdFx0ZG9jdW1lbnQsXHJcblx0XHRcdFx0XCJjbGlja1wiIGFzIGtleW9mIEhUTUxFbGVtZW50RXZlbnRNYXAsXHJcblx0XHRcdFx0XCIuYnRuLWRlbGV0ZVwiLFxyXG5cdFx0XHRcdHRoaXMub25DbGljay5iaW5kKHRoaXMpXHJcblx0XHRcdClcclxuXHRcdCk7XHJcblx0fVxyXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKFxyXG5cdFx0XHR7fSxcclxuXHRcdFx0REVGQVVMVF9TRVRUSU5HUyxcclxuXHRcdFx0YXdhaXQgdGhpcy5sb2FkRGF0YSgpXHJcblx0XHQpO1xyXG5cdH1cclxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG5cdH1cclxuXHRvbkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0Y29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIEVsZW1lbnQ7XHJcblx0XHRjb25zdCBub2RlVHlwZSA9IHRhcmdldC5sb2NhbE5hbWU7XHJcblx0XHRsZXQgZGVsX2J0bjogSFRNTEJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFxyXG5cdFx0XHRcImJ1dHRvblwiXHJcblx0XHQpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG5cdFx0aWYgKFxyXG5cdFx0XHRub2RlVHlwZSA9PT0gXCJidXR0b25cIiB8fFxyXG5cdFx0XHRub2RlVHlwZSA9PT0gXCJzdmdcIiB8fFxyXG5cdFx0XHRub2RlVHlwZSA9PT0gXCJwYXRoXCJcclxuXHRcdCkge1xyXG5cdFx0XHRkZWxfYnRuID0gdGFyZ2V0LmNsb3Nlc3QoXCIuYnRuLWRlbGV0ZVwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuXHRcdFx0aW1nX3RhcmdldCA9IGRlbF9idG4ucGFyZW50Tm9kZT8ucXVlcnlTZWxlY3RvcihcclxuXHRcdFx0XHRcImltZ1wiXHJcblx0XHRcdCkgYXMgSFRNTEltYWdlRWxlbWVudDtcclxuXHRcdFx0Y29uc3QgY3VycmVudE1kID0gYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCkgYXMgVEZpbGU7XHJcblx0XHRcdGNvbnN0IGltZ0Jhc2VOYW1lID0gaW1nX3RhcmdldC5wYXJlbnRFbGVtZW50Py5nZXRBdHRyaWJ1dGUoXHJcblx0XHRcdFx0XCJzcmNcIlxyXG5cdFx0XHQpIGFzIHN0cmluZztcclxuXHRcdFx0aWYgKFV0aWwuaXNSZW1vdmVJbWFnZShpbWdCYXNlTmFtZSBhcyBzdHJpbmcpWzBdIGFzIGJvb2xlYW4pIHtcclxuXHRcdFx0XHRVdGlsLmRlbGV0ZUltZyhpbWdfdGFyZ2V0LCBpbWdCYXNlTmFtZSBhcyBzdHJpbmcsIHRoaXMpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvbnN0IGxvZ3M6IHN0cmluZ1tdID0gVXRpbC5pc1JlbW92ZUltYWdlKFxyXG5cdFx0XHRcdFx0aW1nQmFzZU5hbWUgYXMgc3RyaW5nXHJcblx0XHRcdFx0KVsxXSBhcyBzdHJpbmdbXTtcclxuXHRcdFx0XHRjb25zdCBtb2RhbCA9IG5ldyBMb2dzTW9kYWwoXHJcblx0XHRcdFx0XHRjdXJyZW50TWQsXHJcblx0XHRcdFx0XHRpbWdCYXNlTmFtZSxcclxuXHRcdFx0XHRcdGxvZ3MsXHJcblx0XHRcdFx0XHR0aGlzLmFwcFxyXG5cdFx0XHRcdCk7XHJcblx0XHRcdFx0bW9kYWwub3BlbigpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQgTmF0aGFuRGVsZXRlSW1hZ2UgZnJvbSBcIi4vbWFpblwiO1xyXG5pbXBvcnQgeyBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBBcHAgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuZXhwb3J0IGludGVyZmFjZSBOYXRoYW5EZWxldGVJbWFnZVNldHRpbmdzIHtcclxuXHRkZWxldGVPcHRpb246IHN0cmluZztcclxuXHRsb2dzTW9kYWw6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBOYXRoYW5EZWxldGVJbWFnZVNldHRpbmdzID0ge1xyXG5cdGRlbGV0ZU9wdGlvbjogXCIudHJhc2hcIixcclxuXHRsb2dzTW9kYWw6IHRydWUsXHJcbn07XHJcbmV4cG9ydCBjbGFzcyBOYXRoYW5EZWxldGVJbWFnZVNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcblx0cGx1Z2luOiBOYXRoYW5EZWxldGVJbWFnZTtcclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBOYXRoYW5EZWxldGVJbWFnZSkge1xyXG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xyXG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcblx0fVxyXG5cdGRpc3BsYXkoKTogdm9pZCB7XHJcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIkZhc3QgSW1hZ2UgQ2xlYW5lciBTZXR0aW5nc1wiIH0pO1xyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKFwiRGVsZXRlZCBJbWFnZSBEZXN0aW5hdGlvblwiKVxyXG5cdFx0XHQuc2V0RGVzYyhcclxuXHRcdFx0XHRcIlNlbGVjdCB3aGVyZSB5b3Ugd2FudCBpbWFnZXMgdG8gYmUgbW92ZWQgb25jZSB0aGV5IGFyZSBkZWxldGVkXCJcclxuXHRcdFx0KVxyXG5cdFx0XHQuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XHJcblx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKFwicGVybWFuZW50XCIsIFwiRGVsZXRlIFBlcm1hbmVudGx5XCIpO1xyXG5cdFx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihcIi50cmFzaFwiLCBcIk1vdmUgdG8gT2JzaWRpYW4gVHJhc2hcIik7XHJcblx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKFwic3lzdGVtLXRyYXNoXCIsIFwiTW92ZSB0byBTeXN0ZW0gVHJhc2hcIik7XHJcblx0XHRcdFx0ZHJvcGRvd24uc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVsZXRlT3B0aW9uKTtcclxuXHRcdFx0XHRkcm9wZG93bi5vbkNoYW5nZSgob3B0aW9uKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWxldGVPcHRpb24gPSBvcHRpb247XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSk7XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQgeyBURmlsZSwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCBOYXRoYW5EZWxldGVJbWFnZSBmcm9tIFwiLi9tYWluXCI7XHJcblxyXG5jb25zdCBpbWFnZUV4dGVuc2lvbnM6IFNldDxzdHJpbmc+ID0gbmV3IFNldChbXHJcblx0XCJqcGVnXCIsXHJcblx0XCJqcGdcIixcclxuXHRcInBuZ1wiLFxyXG5cdFwiZ2lmXCIsXHJcblx0XCJzdmdcIixcclxuXHRcImJtcFwiLFxyXG5dKTtcclxuY29uc3QgU1VDQ0VTU19OT1RJQ0VfVElNRU9VVCA9IDE4MDA7XHJcbmV4cG9ydCBjb25zdCBnZXRBbGxJbWdEaXZzID0gKCk6IEhUTUxDb2xsZWN0aW9uID0+IHtcclxuXHRjb25zdCBsZWFmX2FjdGl2ZTogSFRNTENvbGxlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxyXG5cdFx0XCJ3b3Jrc3BhY2UtbGVhZiBtb2QtYWN0aXZlXCJcclxuXHQpO1xyXG5cdGNvbnN0IHByZXZpZXdfY29udGVudDogSFRNTENvbGxlY3Rpb24gPVxyXG5cdFx0bGVhZl9hY3RpdmVbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcclxuXHRcdFx0XCJtYXJrZG93bi1zb3VyY2UtdmlldyBjbS1zLW9ic2lkaWFuIG1vZC1jbTYgaXMtZm9sZGluZyBpcy1saXZlLXByZXZpZXcgbm9kZS1pbnNlcnQtZXZlbnRcIlxyXG5cdFx0KTtcclxuXHRjb25zdCBlbWJlZF9kaXZzOiBIVE1MQ29sbGVjdGlvbiA9XHJcblx0XHRwcmV2aWV3X2NvbnRlbnRbMF0/LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXHJcblx0XHRcdFwiaW50ZXJuYWwtZW1iZWQgbWVkaWEtZW1iZWQgaW1hZ2UtZW1iZWQgaXMtbG9hZGVkXCJcclxuXHRcdCk7XHJcblx0cmV0dXJuIGVtYmVkX2RpdnM7XHJcbn07XHJcbmV4cG9ydCBjb25zdCByZW1vdmVJbWdEb20gPSAodGFyZ2V0OiBIVE1MRWxlbWVudCkgPT4ge1xyXG5cdGNvbnN0IGltZ19kaXY6IEhUTUxEaXZFbGVtZW50ID0gdGFyZ2V0LnBhcmVudEVsZW1lbnQgYXMgSFRNTERpdkVsZW1lbnQ7XHJcblx0Y29uc3QgY29udGVudF9jb250YWluZXI6IEhUTUxEaXZFbGVtZW50ID0gdGFyZ2V0LnBhcmVudEVsZW1lbnRcclxuXHRcdD8ucGFyZW50RWxlbWVudCBhcyBIVE1MRGl2RWxlbWVudDtcclxuXHRjb250ZW50X2NvbnRhaW5lci5yZW1vdmVDaGlsZChpbWdfZGl2KTtcclxufTtcclxuY29uc3QgdHJpbUZyb21SZWdFeHAgPSAob3JpZ2luX3N0cjogc3RyaW5nLCByZWdleDogUmVnRXhwKTogc3RyaW5nID0+IHtcclxuXHRjb25zdCBtYXRjaGluZ19hcnJheSA9IEFycmF5LmZyb20ob3JpZ2luX3N0ci5tYXRjaEFsbChyZWdleCkpO1xyXG5cdGZvciAobGV0IGkgPSAwOyBpIDwgbWF0Y2hpbmdfYXJyYXkubGVuZ3RoOyBpKyspIHtcclxuXHRcdG9yaWdpbl9zdHIgPSBvcmlnaW5fc3RyLnJlcGxhY2UobWF0Y2hpbmdfYXJyYXlbaV1bMF0sIFwiXCIpO1xyXG5cdH1cclxuXHRyZXR1cm4gb3JpZ2luX3N0cjtcclxufTtcclxuZXhwb3J0IGNvbnN0IHJlbW92ZVJlZmVyZW5jZUxpbmsgPSBhc3luYyAoaW1hZ2VQYXRoOiBzdHJpbmcsIG1kRmlsZTogVEZpbGUpID0+IHtcclxuXHRjb25zdCBvcmlnaW5fZmlsZWNvbnRlbnRzID0gYXdhaXQgYXBwLnZhdWx0LnJlYWQobWRGaWxlKTtcclxuXHRjb25zdCBuZXdfZmlsZWNvbnRlbnRzOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuXHRjb25zdCBmaWxlQ29udGVudHNfYXJyYXkgPSBvcmlnaW5fZmlsZWNvbnRlbnRzLnNwbGl0KFwiXFxuXCIpO1xyXG5cclxuXHRmb3IgKGNvbnN0IGZpbGVDb250ZW50IG9mIGZpbGVDb250ZW50c19hcnJheSkge1xyXG5cdFx0Y29uc3QgcmVnUmVmTGluazEgPSBuZXcgUmVnRXhwKFxyXG5cdFx0XHRcIiFcXFxcWyguKik/XFxcXF1cXFxcKCgoLipcXFxcLykrKT9cIiArIGltYWdlUGF0aCArIFwiXFxcXClcIixcclxuXHRcdFx0XCJnbVwiXHJcblx0XHQpOyAvLyBtYXJrZG93blxyXG5cdFx0Y29uc3QgcmVnUmVmTGluazIgPSBuZXcgUmVnRXhwKFxyXG5cdFx0XHRcIiFcXFxcW1xcXFxbLio/XCIgKyBpbWFnZVBhdGggKyBcIlxcXFxdXFxcXF1cIixcclxuXHRcdFx0XCJnbVwiXHJcblx0XHQpOyAvLyB3aWtpXHJcblxyXG5cdFx0Y29uc3QgaXNFc2NhcGVkID0gZmlsZUNvbnRlbnQuaW5jbHVkZXMoXCIlMjBcIik7XHJcblx0XHRjb25zdCBmaWxlQ29udGVudF9kZWNvZGUgPSBkZWNvZGVVUkkoZmlsZUNvbnRlbnQpO1xyXG5cclxuXHRcdGNvbnN0IGlzSW5jbHVkZUltYWdlID0gZmlsZUNvbnRlbnRfZGVjb2RlLmluY2x1ZGVzKGltYWdlUGF0aCk7XHJcblx0XHRjb25zdCBpc01hcmtkb3duU3R5bGUgPSBmaWxlQ29udGVudF9kZWNvZGUubWF0Y2gocmVnUmVmTGluazEpICE9IG51bGw7XHJcblx0XHRjb25zdCBpc1dpa2lTdHlsZSA9IGZpbGVDb250ZW50X2RlY29kZS5tYXRjaChyZWdSZWZMaW5rMikgIT0gbnVsbDtcclxuXHJcblx0XHRpZiAoaXNFc2NhcGVkKSB7XHJcblx0XHRcdGlmIChpc0luY2x1ZGVJbWFnZSAmJiBpc01hcmtkb3duU3R5bGUpIHtcclxuXHRcdFx0XHRuZXdfZmlsZWNvbnRlbnRzLnB1c2goXHJcblx0XHRcdFx0XHR0cmltRnJvbVJlZ0V4cChmaWxlQ29udGVudF9kZWNvZGUsIHJlZ1JlZkxpbmsxKVxyXG5cdFx0XHRcdCk7XHJcblx0XHRcdH0gZWxzZSBpZiAoaXNJbmNsdWRlSW1hZ2UgJiYgaXNXaWtpU3R5bGUpIHtcclxuXHRcdFx0XHRuZXdfZmlsZWNvbnRlbnRzLnB1c2goXHJcblx0XHRcdFx0XHR0cmltRnJvbVJlZ0V4cChmaWxlQ29udGVudF9kZWNvZGUsIHJlZ1JlZkxpbmsyKVxyXG5cdFx0XHRcdCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0bmV3X2ZpbGVjb250ZW50cy5wdXNoKGZpbGVDb250ZW50KTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0aWYgKGlzSW5jbHVkZUltYWdlICYmIGlzTWFya2Rvd25TdHlsZSkge1xyXG5cdFx0XHRcdG5ld19maWxlY29udGVudHMucHVzaChcclxuXHRcdFx0XHRcdHRyaW1Gcm9tUmVnRXhwKGZpbGVDb250ZW50X2RlY29kZSwgcmVnUmVmTGluazEpXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0fSBlbHNlIGlmIChpc0luY2x1ZGVJbWFnZSAmJiBpc1dpa2lTdHlsZSkge1xyXG5cdFx0XHRcdG5ld19maWxlY29udGVudHMucHVzaChcclxuXHRcdFx0XHRcdHRyaW1Gcm9tUmVnRXhwKGZpbGVDb250ZW50X2RlY29kZSwgcmVnUmVmTGluazIpXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRuZXdfZmlsZWNvbnRlbnRzLnB1c2goZmlsZUNvbnRlbnQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdGFwcC52YXVsdC5hZGFwdGVyLndyaXRlKG1kRmlsZS5wYXRoLCBuZXdfZmlsZWNvbnRlbnRzLmpvaW4oXCJcXG5cIikpO1xyXG59O1xyXG5leHBvcnQgY29uc3QgYWRkRGVsQnRuID0gKGltZ19saXN0OiBIVE1MQ29sbGVjdGlvbikgPT4ge1xyXG5cdGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBpbWdfbGlzdD8ubGVuZ3RoOyBpbmRleCsrKSB7XHJcblx0XHRjb25zdCBidG5fZGVsOiBIVE1MQnV0dG9uRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcblx0XHRidG5fZGVsLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiYnRuLWRlbGV0ZVwiKTtcclxuXHRcdGJ0bl9kZWwuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIkRlbGV0ZSBjdXJyZW50IGltYWdlXCIpO1xyXG5cdFx0YnRuX2RlbC5pbm5lckhUTUwgPVxyXG5cdFx0XHQnPHN2ZyBmaWxsPVwiI2ZmMDAwMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDY0IDY0XCIgd2lkdGg9XCI0OHB4XCIgaGVpZ2h0PVwiNDhweFwiPjxwYXRoIGQ9XCJNIDI4IDcgQyAyNS4yNDMgNyAyMyA5LjI0MyAyMyAxMiBMIDIzIDE1IEwgMTMgMTUgQyAxMS44OTYgMTUgMTEgMTUuODk2IDExIDE3IEMgMTEgMTguMTA0IDExLjg5NiAxOSAxMyAxOSBMIDE1LjEwOTM3NSAxOSBMIDE2Ljc5Mjk2OSA0OS4zMzIwMzEgQyAxNi45NzA5NjkgNTIuNTEwMDMxIDE5LjYwMDIwMyA1NSAyMi43ODMyMDMgNTUgTCA0MS4yMTY3OTcgNTUgQyA0NC4zOTg3OTcgNTUgNDcuMDI5MDMxIDUyLjUxMDAzMSA0Ny4yMDcwMzEgNDkuMzMyMDMxIEwgNDguODkwNjI1IDE5IEwgNTEgMTkgQyA1Mi4xMDQgMTkgNTMgMTguMTA0IDUzIDE3IEMgNTMgMTUuODk2IDUyLjEwNCAxNSA1MSAxNSBMIDQxIDE1IEwgNDEgMTIgQyA0MSA5LjI0MyAzOC43NTcgNyAzNiA3IEwgMjggNyB6IE0gMjggMTEgTCAzNiAxMSBDIDM2LjU1MiAxMSAzNyAxMS40NDkgMzcgMTIgTCAzNyAxNSBMIDI3IDE1IEwgMjcgMTIgQyAyNyAxMS40NDkgMjcuNDQ4IDExIDI4IDExIHogTSAxOS4xMTMyODEgMTkgTCA0NC44ODY3MTkgMTkgTCA0My4yMTI4OTEgNDkuMTA5Mzc1IEMgNDMuMTUzODkxIDUwLjE2OTM3NSA0Mi4yNzc3OTcgNTEgNDEuMjE2Nzk3IDUxIEwgMjIuNzgzMjAzIDUxIEMgMjEuNzIzMjAzIDUxIDIwLjg0NjEwOSA1MC4xNzAzMjggMjAuNzg3MTA5IDQ5LjExMTMyOCBMIDE5LjExMzI4MSAxOSB6IE0gMzIgMjMuMjUgQyAzMS4wMzMgMjMuMjUgMzAuMjUgMjQuMDM0IDMwLjI1IDI1IEwgMzAuMjUgNDUgQyAzMC4yNSA0NS45NjYgMzEuMDMzIDQ2Ljc1IDMyIDQ2Ljc1IEMgMzIuOTY3IDQ2Ljc1IDMzLjc1IDQ1Ljk2NiAzMy43NSA0NSBMIDMzLjc1IDI1IEMgMzMuNzUgMjQuMDM0IDMyLjk2NyAyMy4yNSAzMiAyMy4yNSB6IE0gMjQuNjQyNTc4IDIzLjI1MTk1MyBDIDIzLjY3NzU3OCAyMy4yODU5NTMgMjIuOTIyMDc4IDI0LjA5NDU0NyAyMi45NTUwNzggMjUuMDYwNTQ3IEwgMjMuNjUyMzQ0IDQ1LjE0NjQ4NCBDIDIzLjY4NTM0NCA0Ni4wOTE0ODQgMjQuNDYyMzkxIDQ2LjgzNTkzOCAyNS40MDAzOTEgNDYuODM1OTM4IEMgMjUuNDIxMzkxIDQ2LjgzNTkzOCAyNS40NDE4OTEgNDYuODM1OTM4IDI1LjQ2Mjg5MSA0Ni44MzU5MzggQyAyNi40Mjc4OTEgNDYuODAxOTM4IDI3LjE4MzM5MSA0NS45OTEzOTEgMjcuMTUwMzkxIDQ1LjAyNTM5MSBMIDI2LjQ1MzEyNSAyNC45Mzk0NTMgQyAyNi40MTkxMjUgMjMuOTc0NDUzIDI1LjYwNjU3OCAyMy4yMjg5NTMgMjQuNjQyNTc4IDIzLjI1MTk1MyB6IE0gMzkuMzU1NDY5IDIzLjI1MTk1MyBDIDM4LjM4ODQ2OSAyMy4yMjQ5NTMgMzcuNTgwODc1IDIzLjk3NDQ1MyAzNy41NDY4NzUgMjQuOTM5NDUzIEwgMzYuODQ5NjA5IDQ1LjAyNTM5MSBDIDM2LjgxNTYwOSA0NS45OTEzOTEgMzcuNTcxMTA5IDQ2LjgwMTkzOCAzOC41MzcxMDkgNDYuODM1OTM4IEMgMzguNTU4MTA5IDQ2LjgzNjkzOCAzOC41Nzg2MDkgNDYuODM1OTM4IDM4LjU5OTYwOSA0Ni44MzU5MzggQyAzOS41Mzc2MDkgNDYuODM1OTM4IDQwLjMxNDY1NiA0Ni4wOTE0ODQgNDAuMzQ3NjU2IDQ1LjE0NjQ4NCBMIDQxLjA0NDkyMiAyNS4wNjA1NDcgQyA0MS4wNzg5MjIgMjQuMDk0NTQ3IDQwLjMyMTQ2OSAyMy4yODU5NTMgMzkuMzU1NDY5IDIzLjI1MTk1MyB6XCIgLz48L3N2Zz4nO1xyXG5cdFx0aW1nX2xpc3RbaW5kZXhdLmFwcGVuZENoaWxkKGJ0bl9kZWwpO1xyXG5cdH1cclxufTtcclxuZXhwb3J0IGNvbnN0IGNsZWFyQWxsRGVsQnRucyA9ICgpID0+IHtcclxuXHRjb25zdCBidG5fZGVsczogSFRNTENvbGxlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxyXG5cdFx0XCJidG4tZGVsZXRlXCJcclxuXHQpIGFzIEhUTUxDb2xsZWN0aW9uO1xyXG5cdEFycmF5LmZyb20oYnRuX2RlbHMpLmZvckVhY2goKGJ0bl9kZWwpID0+IHtcclxuXHRcdGJ0bl9kZWwucGFyZW50Tm9kZT8ucmVtb3ZlQ2hpbGQoYnRuX2RlbCk7XHJcblx0fSk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBnZXRBbGxJbWFnZXMgPSAoKTogVEZpbGVbXSA9PiB7XHJcblx0Y29uc3QgYWxsRmlsZXM6IFRGaWxlW10gPSBhcHAudmF1bHQuZ2V0RmlsZXMoKTtcclxuXHRjb25zdCBhdHRhY2htZW50czogVEZpbGVbXSA9IFtdO1xyXG5cdGZvciAobGV0IGkgPSAwOyBpIDwgYWxsRmlsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdGlmIChhbGxGaWxlc1tpXS5leHRlbnNpb24gIT09IFwibWRcIikge1xyXG5cdFx0XHRpZiAoaW1hZ2VFeHRlbnNpb25zLmhhcyhhbGxGaWxlc1tpXS5leHRlbnNpb24udG9Mb3dlckNhc2UoKSkpIHtcclxuXHRcdFx0XHRhdHRhY2htZW50cy5wdXNoKGFsbEZpbGVzW2ldKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gYXR0YWNobWVudHM7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBpc1JlbW92ZUltYWdlID0gKGltYWdlTmFtZTogc3RyaW5nKTogW2Jvb2xlYW4sIHN0cmluZ1tdXSA9PiB7XHJcblx0Y29uc3QgY3VycmVudE1kID0gYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCkgYXMgVEZpbGU7XHJcblx0Y29uc3QgZGVfaW1nID0gZ2V0SW1hZ2VGaWxlQnlOYW1lKGN1cnJlbnRNZCwgaW1hZ2VOYW1lKSBhcyBURmlsZTtcclxuXHRpZiAoZGVfaW1nID09IHVuZGVmaW5lZCkge1xyXG5cdFx0bmV3IE5vdGljZShgIDExMTFgKTtcclxuXHR9XHJcblx0Y29uc3QgbWRfcGF0aDogc3RyaW5nW10gPSBbXTtcclxuXHRsZXQgY3VyX21kX3BhdGggPSBcIlwiO1xyXG5cdGxldCByZWZfbnVtID0gMDtcclxuXHRjb25zdCByZXNvbHZlZExpbmtzID0gYXBwLm1ldGFkYXRhQ2FjaGUucmVzb2x2ZWRMaW5rcztcclxuXHRsZS5sb2coXCJkZV9pbWcgcGF0aC0tLS0tLS0tXCIgKyBkZV9pbWcucGF0aCk7XHJcblx0Zm9yIChjb25zdCBbbWRGaWxlLCBsaW5rc10gb2YgT2JqZWN0LmVudHJpZXMocmVzb2x2ZWRMaW5rcykpIHtcclxuXHRcdGlmIChjdXJyZW50TWQucGF0aCA9PT0gbWRGaWxlKSB7XHJcblx0XHRcdGN1cl9tZF9wYXRoID0gY3VycmVudE1kLnBhdGg7XHJcblx0XHRcdG1kX3BhdGgudW5zaGlmdChjdXJfbWRfcGF0aCk7XHJcblx0XHR9XHJcblx0XHRmb3IgKGNvbnN0IFtmaWxlUGF0aCwgbnJdIG9mIE9iamVjdC5lbnRyaWVzKGxpbmtzKSkge1xyXG5cdFx0XHRpZiAoZGVfaW1nLnBhdGggPT09IGZpbGVQYXRoKSB7XHJcblx0XHRcdFx0cmVmX251bSsrO1xyXG5cdFx0XHRcdGlmIChuciA+IDEpIHtcclxuXHRcdFx0XHRcdHJlZl9udW0gKz0gMTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0bWRfcGF0aC5wdXNoKG1kRmlsZSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0Y29uc3QgcmVzdWx0OiBib29sZWFuID0gcmVmX251bSA+IDEgPyBmYWxzZSA6IHRydWU7XHJcblx0cmV0dXJuIFtyZXN1bHQsIG1kX3BhdGhdO1xyXG59O1xyXG5leHBvcnQgY29uc3QgZ2V0SW1hZ2VGaWxlQnlOYW1lID0gKFxyXG5cdGN1cnJlbnRNZDogVEZpbGUsXHJcblx0aW1hZ2VOYW1lOiBzdHJpbmdcclxuKTogVEZpbGUgfCB1bmRlZmluZWQgPT4ge1xyXG5cdGNvbnN0IHJlc29sdmVkTGlua3MgPSBhcHAubWV0YWRhdGFDYWNoZS5yZXNvbHZlZExpbmtzO1xyXG5cdGZvciAoY29uc3QgW21kRmlsZSwgbGlua3NdIG9mIE9iamVjdC5lbnRyaWVzKHJlc29sdmVkTGlua3MpKSB7XHJcblx0XHRpZiAoY3VycmVudE1kLnBhdGggPT09IG1kRmlsZSkge1xyXG5cdFx0XHRmb3IgKGNvbnN0IFtmaWxlUGF0aCwgbnJdIG9mIE9iamVjdC5lbnRyaWVzKGxpbmtzKSkge1xyXG5cdFx0XHRcdGlmIChmaWxlUGF0aC5pbmNsdWRlcyhpbWFnZU5hbWUpKSB7XHJcblx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRjb25zdCBpbWFnZUZpbGU6IFRGaWxlID1cclxuXHRcdFx0XHRcdFx0XHRhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKSBhcyBURmlsZTtcclxuXHRcdFx0XHRcdFx0aWYgKGltYWdlRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGltYWdlRmlsZTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0bmV3IE5vdGljZShgIGNhbm5vdCBnZXQgdGhlIGltYWdlIGZpbGVgKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn07XHJcbmV4cG9ydCBjb25zdCBkZWxldGVJbWcgPSAoXHJcblx0dGFyZ2V0SW1nOiBIVE1MSW1hZ2VFbGVtZW50LFxyXG5cdGltYWdlTmFtZTogc3RyaW5nLFxyXG5cdHBsdWdpbjogTmF0aGFuRGVsZXRlSW1hZ2VcclxuKSA9PiB7XHJcblx0Y29uc3QgZGVsZXRlT3B0aW9uID0gcGx1Z2luLnNldHRpbmdzLmRlbGV0ZU9wdGlvbjtcclxuXHRsZXQgZmlsZTogVEZpbGU7XHJcblx0Y29uc3QgaW1nVHlwZSA9IHRhcmdldEltZy5sb2NhbE5hbWU7XHJcblx0c3dpdGNoIChpbWdUeXBlKSB7XHJcblx0XHRjYXNlIFwiaW1nXCI6IHtcclxuXHRcdFx0Y29uc3QgaW1hZ2VVcmwgPSB0YXJnZXRJbWcuY3VycmVudFNyYztcclxuXHRcdFx0Y29uc3QgdGhpc1VSTCA9IG5ldyBVUkwoaW1hZ2VVcmwpO1xyXG5cdFx0XHRjb25zdCBjdXJyZW50TWQgPSBhcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKSBhcyBURmlsZTtcclxuXHRcdFx0ZmlsZSA9IGdldEltYWdlRmlsZUJ5TmFtZShjdXJyZW50TWQsIGltYWdlTmFtZSkgYXMgVEZpbGU7XHJcblx0XHRcdGlmIChmaWxlID09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoXCIgY2Fubm90IGdldCBpbWFnZSBmaWxlIFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRjb25zdCBQcm90byA9IHRoaXNVUkwucHJvdG9jb2w7XHJcblx0XHRcdHN3aXRjaCAoUHJvdG8pIHtcclxuXHRcdFx0XHRjYXNlIFwiYXBwOlwiOlxyXG5cdFx0XHRcdGNhc2UgXCJkYXRhOlwiOlxyXG5cdFx0XHRcdGNhc2UgXCJodHRwOlwiOlxyXG5cdFx0XHRcdGNhc2UgXCJodHRwczpcIjpcclxuXHRcdFx0XHRcdHJlbW92ZVJlZmVyZW5jZUxpbmsoXHJcblx0XHRcdFx0XHRcdGltYWdlTmFtZSxcclxuXHRcdFx0XHRcdFx0YXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCkgYXMgVEZpbGVcclxuXHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0XHRpZiAoZGVsZXRlT3B0aW9uID09PSBcIi50cmFzaFwiKSB7XHJcblx0XHRcdFx0XHRcdGFwcC52YXVsdC50cmFzaChmaWxlLCBmYWxzZSk7XHJcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoXHJcblx0XHRcdFx0XHRcdFx0XCJJbWFnZSBtb3ZlZCB0byBPYnNpZGlhbiBUcmFzaCAhXCIsXHJcblx0XHRcdFx0XHRcdFx0U1VDQ0VTU19OT1RJQ0VfVElNRU9VVFxyXG5cdFx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChkZWxldGVPcHRpb24gPT09IFwic3lzdGVtLXRyYXNoXCIpIHtcclxuXHRcdFx0XHRcdFx0YXBwLnZhdWx0LnRyYXNoKGZpbGUsIHRydWUpO1xyXG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKFxyXG5cdFx0XHRcdFx0XHRcdFwiSW1hZ2UgbW92ZWQgdG8gU3lzdGVtIFRyYXNoICFcIixcclxuXHRcdFx0XHRcdFx0XHRTVUNDRVNTX05PVElDRV9USU1FT1VUXHJcblx0XHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKGRlbGV0ZU9wdGlvbiA9PT0gXCJwZXJtYW5lbnRcIikge1xyXG5cdFx0XHRcdFx0XHRhcHAudmF1bHQuZGVsZXRlKGZpbGUpO1xyXG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKFxyXG5cdFx0XHRcdFx0XHRcdFwiSW1hZ2UgZGVsZXRlZCBQZXJtYW5lbnRseSAhXCIsXHJcblx0XHRcdFx0XHRcdFx0U1VDQ0VTU19OT1RJQ0VfVElNRU9VVFxyXG5cdFx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0ZGVmYXVsdDpcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoYG5vIGhhbmRsZXIgZm9yICR7UHJvdG99IHByb3RvY29sYCk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcblx0XHRkZWZhdWx0OlxyXG5cdFx0XHRuZXcgTm90aWNlKFwiTm8gaGFuZGxlciBmb3IgdGhpcyBpbWFnZSB0eXBlIVwiKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdH1cclxufTtcclxuIiwgImltcG9ydCB7IE1vZGFsLCBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IHJlbW92ZVJlZmVyZW5jZUxpbmsgfSBmcm9tIFwiLi91dGlsXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTG9nc01vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG5cdHRleHRUb1ZpZXc6IHN0cmluZ1tdO1xyXG5cdGN1cnJlbnRNZDogVEZpbGU7XHJcblx0aW1nQmFzZU5hbWU6IHN0cmluZztcclxuXHJcblx0Y29uc3RydWN0b3IoXHJcblx0XHRjdXJyZW50TWQ6IFRGaWxlLFxyXG5cdFx0aW1nQmFzZU5hbWU6IHN0cmluZyxcclxuXHRcdHRleHRUb1ZpZXc6IHN0cmluZ1tdLFxyXG5cdFx0YXBwOiBBcHBcclxuXHQpIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0XHR0aGlzLnRleHRUb1ZpZXcgPSB0ZXh0VG9WaWV3O1xyXG5cdFx0dGhpcy5jdXJyZW50TWQgPSBjdXJyZW50TWQ7XHJcblx0XHR0aGlzLmltZ0Jhc2VOYW1lID0gaW1nQmFzZU5hbWU7XHJcblx0fVxyXG5cclxuXHRnZXRMb2coKTogc3RyaW5nIHtcclxuXHRcdGNvbnN0IGZpc3RFbGU6IHN0cmluZyA9IHRoaXMudGV4dFRvVmlldy5zaGlmdCgpIGFzIHN0cmluZztcclxuXHRcdGNvbnN0IGN1cl9tZDogc3RyaW5nID1cclxuXHRcdFx0XCJUaGUgbWQgZG9jdW1lbnQgdGhhdCBjdXJyZW50bHkgcmVmZXJlbmNlcyB0aGUgaW1hZ2U6IDwvYnI+XCIgK1xyXG5cdFx0XHRmaXN0RWxlICtcclxuXHRcdFx0XCI8L2JyPjwvYnI+XCI7XHJcblxyXG5cdFx0bGV0IG90aGVyX21kOiBzdHJpbmcgPSB0aGlzLnRleHRUb1ZpZXcuam9pbihcIjwvYnI+XCIpO1xyXG5cdFx0b3RoZXJfbWQgPVxyXG5cdFx0XHRcIkxpc3Qgb2YgYWxsIGRvY3VtZW50cyB0aGF0IHJlZmVyZW5jZSB0aGlzIGltYWdlOiA8L2JyPlwiICsgb3RoZXJfbWQ7XHJcblx0XHRjb25zdCBsb2c6IHN0cmluZyA9IGN1cl9tZCArIG90aGVyX21kO1xyXG5cdFx0cmV0dXJuIGxvZztcclxuXHR9XHJcblxyXG5cdG9uT3BlbigpIHtcclxuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cdFx0Y29uc3QgbXlNb2RhbCA9IHRoaXM7XHJcblx0XHRjb25zdCBoZWFkZXJXcmFwcGVyID0gY29udGVudEVsLmNyZWF0ZUVsKFwiZGl2XCIpO1xyXG5cdFx0aGVhZGVyV3JhcHBlci5hZGRDbGFzcyhcImZhc3QtaW1hZ2UtY2xlYW5lci1jZW50ZXItd3JhcHBlclwiKTtcclxuXHRcdGNvbnN0IGhlYWRlckVsID0gaGVhZGVyV3JhcHBlci5jcmVhdGVFbChcImgxXCIsIHtcclxuXHRcdFx0dGV4dDogXCIgRGV0ZWN0aW9uIG9mIG11bHRpcGxlIGltYWdlIHJlZmVyZW5jZSBsaW5rcyAtIGxvZ3MgXCIsXHJcblx0XHR9KTtcclxuXHRcdGhlYWRlckVsLmFkZENsYXNzKFwibW9kYWwtdGl0bGVcIik7XHJcblx0XHRjb25zdCBsb2dzID0gY29udGVudEVsLmNyZWF0ZUVsKFwiZGl2XCIpO1xyXG5cdFx0bG9ncy5hZGRDbGFzcyhcImZhc3QtaW1hZ2UtY2xlYW5lci1sb2dcIik7XHJcblx0XHRsb2dzLmlubmVySFRNTCA9IHRoaXMuZ2V0TG9nKCk7XHJcblx0XHRjb25zdCBidXR0b25XcmFwcGVyID0gY29udGVudEVsLmNyZWF0ZUVsKFwiZGl2XCIpO1xyXG5cdFx0YnV0dG9uV3JhcHBlci5hZGRDbGFzcyhcImZhc3QtaW1hZ2UtY2xlYW5lci1jZW50ZXItd3JhcHBlclwiKTtcclxuXHJcblx0XHRjb25zdCBjbG9zZUJ1dHRvbiA9IGJ1dHRvbldyYXBwZXIuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcImNsb3NlXCIgfSk7XHJcblx0XHRjb25zdCByZW1vdmVMaW5rQnV0dG9uID0gYnV0dG9uV3JhcHBlci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XHJcblx0XHRcdHRleHQ6IFwicmVtb3ZlIGxpbmtcIixcclxuXHRcdH0pO1xyXG5cclxuXHRcdGNsb3NlQnV0dG9uLmFkZENsYXNzKFwidW51c2VkLWltYWdlcy1idXR0b25cIik7XHJcblx0XHRjbG9zZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIFwiY2xvc2UgdGhlIHdpbmRvd1wiKTtcclxuXHRcdHJlbW92ZUxpbmtCdXR0b24uYWRkQ2xhc3MoXCJ1bnVzZWQtaW1hZ2VzLWJ1dHRvblwiKTtcclxuXHRcdHJlbW92ZUxpbmtCdXR0b24uc2V0QXR0cmlidXRlKFxyXG5cdFx0XHRcImFyaWEtbGFiZWxcIixcclxuXHRcdFx0XCJDb250aW51ZSB0byByZW1vdmUgdGhlIHJlZmVyZW5jZSBsaW5rIHRvIHRoZSBjdXJyZW50IGltYWdlIGluIHRoZSBjdXJyZW50IGRvY3VtZW50XCJcclxuXHRcdCk7XHJcblx0XHRjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cdFx0XHRteU1vZGFsLmNsb3NlKCk7XHJcblx0XHR9KTtcclxuXHRcdHJlbW92ZUxpbmtCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuXHRcdFx0cmVtb3ZlUmVmZXJlbmNlTGluayh0aGlzLmltZ0Jhc2VOYW1lLCB0aGlzLmN1cnJlbnRNZCk7XHJcblx0XHRcdG15TW9kYWwuY2xvc2UoKTtcclxuXHRcdH0pO1xyXG5cdH1cclxufVxyXG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQThCOzs7QUNDOUIsc0JBQStDO0FBTXhDLElBQU0sbUJBQThDO0FBQUEsRUFDMUQsY0FBYztBQUFBLEVBQ2QsV0FBVztBQUNaO0FBQ08sSUFBTSwrQkFBTixjQUEyQyxpQ0FBaUI7QUFBQSxFQUVsRSxZQUFZLE1BQVUsUUFBMkI7QUFDaEQsVUFBTSxNQUFLLE1BQU07QUFDakIsU0FBSyxTQUFTO0FBQUEsRUFDZjtBQUFBLEVBQ0EsVUFBZ0I7QUFDZixVQUFNLEVBQUUsZ0JBQWdCO0FBQ3hCLGdCQUFZLE1BQU07QUFDbEIsZ0JBQVksU0FBUyxNQUFNLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUNsRSxRQUFJLHdCQUFRLFdBQVcsRUFDckIsUUFBUSwyQkFBMkIsRUFDbkMsUUFDQSxnRUFDRCxFQUNDLFlBQVksQ0FBQyxhQUFhO0FBQzFCLGVBQVMsVUFBVSxhQUFhLG9CQUFvQjtBQUNwRCxlQUFTLFVBQVUsVUFBVSx3QkFBd0I7QUFDckQsZUFBUyxVQUFVLGdCQUFnQixzQkFBc0I7QUFDekQsZUFBUyxTQUFTLEtBQUss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
